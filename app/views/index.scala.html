@import model.Evento
@import model.EventosDia

@(eventosAgora: Seq[Evento],
  eventosHoje: Seq[Evento],
  eventosDia: Seq[EventosDia],
  atualizadoEm: String,
  proxEventoMiliSec: Option[Long],
  jsonld: String,
  tags: Seq[String])

@displayEvento(evento: Evento, full: Boolean = false, agora: Boolean = false) = {
<div class="testi-item" data-jplist-item>
  <div class="testi-meta-inner d-flex">
    <div class="testi-img mr-2">
      @if(agora) {
        @if(evento.linkLive.isDefined) {
          <a class="icone" rel="nofollow" href="@evento.linkLive.get" target="_blank">
            <span class="@evento.iconeLive"></span>
          </a>
        } else {
          <div class="icone">
            <span class="@evento.iconeLive"></span>
          </div>
        }
      } else {
        <span class="icon-calendar"></span>
      }

    </div>
    <div class="testi-details">
      <a class="link-no-decoration" data-toggle="collapse" 
        href='#@evento.generatedId' 
        role="button" aria-expanded="false" 
        aria-controls='@evento.generatedId'>
        <p class="testi-destaque mb-0 searchable">
          @evento.nome
          @if(evento.destaque) {
            <span class="icon-star"></span>
          }
          @if(evento.encerrado.getOrElse(false)){
            <i>(Encerrado)</i>
          }

        </p>      
        @if(evento.info.nonEmpty) {
        <p class="testi-info mb-0 searchable">
          @evento.info
        </p>
        }
        @for(tag <- evento.tags){
          <span class="badge badge-live @tag">@tag</span>
        }
        <p class="testi-desc mb-0">
          @evento.horarioFmt
          <span class="icon-caret-square-o-down"></span>
          <span class="icon-caret-square-o-up"></span>
        </p>
      </a>
    </div>
  </div>
  <div class="collapse multi-collapse" id='@evento.generatedId'>
    <div class="card card-body bg-transparent">
      <div class="icones-previa">
        @if(evento.youtubeLink.isDefined) {
          <a class="icone" rel="nofollow" href="@evento.youtubeLink.get" target="_blank">
            <span class="icon icon-youtube1"></span>
          </a>
        }
        @if(evento.instagramProfile.isDefined && (!agora || (agora && evento.youtubeData.flatMap(_.link).isDefined)))  {
          <a class="icone" rel="nofollow" href="@evento.instagramProfile.get" target="_blank">
            <span class="icon icon-instagram"></span>
          </a>
        }
      </div>
      
      <span class="h6">
        Compartilhar live
        <a class="link-no-decoration" href='https://wa.me/?text=@evento.urlEncodedShare' target="_blank">
          <span class="icon-whatsapp"></span>
        </a>
        <a class="link-no-decoration" href='https://twitter.com/intent/tweet?text=@evento.urlEncodedShare' target="_blank">
          <span class="icon-twitter"></span>
        </a>
        <a class="link-no-decoration" href='https://www.facebook.com/sharer/sharer.php?u=livesdodia.com.br&quote=@evento.urlEncodedShareFacebook' target="_blank">
          <span class="icon-facebook-square"></span>
        </a>
      </span>
    </div>
  </div>
</div>
}

@tituloHoje() = {
  @if(eventosAgora.nonEmpty) {
    Em breve
  } else {
    Hoje
  }
}

@buscanaoencontrada() = {
  <div class="testi-item busca-nao-encontrada" style="display: none">
    Live não encontrada nessa seção, refaça a busca ou <a href="/incluir">cadastre uma nova</a>.
  </div>
}

@base {

  <!-- INICIADAS -->
  @if(eventosAgora.nonEmpty) {
  <section class="section-padding bg-white">
    <div class="container">
      <div class="section-content shadow destaque-box" data-aos="fade-up">
        <div class="heading-section text-center">
          <h2>
            Já começou
          </h2>
        </div>
        <div class="row">
          <div class="testi-content search-not-found-container" data-jplist-group="search-group">
            @for(evento <- eventosAgora) {
              @displayEvento(evento, true, true)
            }
            @buscanaoencontrada
          </div>
        </div>
      </div>
    </div>
  </section>
  }
  <!-- FIM INICIADA -->

  @if(eventosHoje.nonEmpty) {
  <section class="section-padding bg-fixed bg-white">
    <div class="container">
      <div class="section-content shadow destaque-box" data-aos="fade-up">
        <div class="heading-section text-center">
          <h2>
            @tituloHoje()
          </h2>
        </div>
        <div class="row">
          <div class="testi-content search-not-found-container" data-jplist-group="search-group">
            @for(evento <- eventosHoje) {
              @displayEvento(evento, true)
            }
            @buscanaoencontrada
          </div>
        </div>
      </div>
    </div>
  </section>
  }

  <div class="tags">
    <button type="button" data-jplist-control="buttons-text-filter" data-path=".badge" data-group="search-group"
      data-mode="radio" data-selected="true" data-text="" class="badge badge-live jplist-selected" data-name="buttons-text-filter">
      Todos
    </button>
    @for(tag <- tags) {
    <button type="button" data-jplist-control="buttons-text-filter" data-path=".badge" data-group="search-group" 
      data-mode="radio" data-text="@tag" class="badge badge-live" data-name="buttons-text-filter">
      @tag
    </button>
    }
  </div>

  <section id="client" class="overlay bg-fixed" style='background-image: url(@routes.Assets.versioned("img/bg.jpg"));'>
    <div class="container">
      <div class="section-content" data-aos="fade-up">
        <div class="row">
          <div class="col-md-12">
            <div class="title-wrap">
              <h2>Programação</h2>
            </div>
          </div>
          <!-- Client Holder -->
          <div class="col-md-12 client-holder search-not-found-container">
            @buscanaoencontrada
            <div class="client-slider">
              @for(item <- eventosDia){
              <div class="shadow dia-box">
                <div class="heading-section text-center">
                  <p>
                    @item.diaProgramacaoFmt
                  </p>
                  <h2 class="mb-4">
                    @item.diaFmt
                  </h2>
                </div>
                <div data-jplist-group="search-group">
                  @for(evento <- item.eventos){
                    @displayEvento(evento, false)
                  }
                </div>
              </div>
              }
            </div>
            <!-- End of Client Holder -->
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <section class="bg-white">
    <div class="container">
      <div class="section-content">
        <div class="title-wrap">
          <h2 class="section-title">
            Alguma live ainda <b>não está na nossa agenda?</b> Você pode cadastrar <a class="" href="/incluir">aqui</a>.
          </h2>
          <p class="section-sub-title">
            Valorize o artista, assista nos canais oficiais
          </p>
        </div>
      </div>
    </div>
  </section>

  @if(proxEventoMiliSec.isDefined){
    <script type="text/javascript">
      setTimeout(function(){
        location.reload(true);
      },@proxEventoMiliSec.get)
    </script>
  }

}(Some(jsonld), true)