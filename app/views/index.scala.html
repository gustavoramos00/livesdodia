@import model.Evento
@import model.EventosDia

@(eventosAgora: Seq[Evento],
  demaisEventosHoje: Seq[Evento],
  eventosDia: Seq[EventosDia],
  atualizadoEm: String,
  jsonld: String,
  tags: Seq[(String, String)])


@*
*<!--@tagSelected(tag: String) = {@(tag.equals("Música") && eventosAgora.flatMap(_.tags).contains("Música"))}-->
*@

@tagSelected(tag: String) = {false}

@base {
  <script>
    // 2. This code loads the IFrame Player API code asynchronously.
    var tag = document.createElement('script');

    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    // 3. This function creates an <iframe> (and YouTube player)
    //    after the API code downloads.
    var player;

    function hideElementsPlayVideo() {
      $('.rectangle-1').hide();
      $('.rectangle-2').hide();
      $('.rectangle-transparent-1').hide();
      $('.rectangle-transparent-2').hide();
      $('.header-container').css('background', 'transparent').removeClass('shadow');
      $('section').first().removeClass('maybe-first-section');
    }

    function showElementsPlayVideo() {
      $('.rectangle-1').show();
      $('.rectangle-2').show();
      $('.rectangle-transparent-1').show();
      $('.rectangle-transparent-2').show();
      $('.header-container').css('background', 'linear-gradient(to right, #333399, #ff00cc)').addClass('shadow');
      $('section').first().addClass('maybe-first-section');
    }

    function closeVideo() {
      showElementsPlayVideo();
      player.destroy();
      player = undefined;
      $(".yt-player").removeClass("active");
      ga('send', {
        hitType: 'event',
        eventCategory: 'Lives',
        eventAction: 'video-stop',
        eventAction: 'video-stop',
      });
    }

    function playYoutubeVideoId(videoId, nome) {
      hideElementsPlayVideo();
      if (!player) {
        player = new YT.Player('player', {
        videoId: videoId,
        width: '100%',
        events: {
          'onReady': onPlayerReady
        }
      });
      } else {
        player.loadVideoById(videoId);
      }
      $(".yt-player").addClass("active");
      ga('send', {
        hitType: 'event',
        eventCategory: 'Lives',
        eventAction: 'video-play',
        eventLabel: nome
      });
    }

    // 4. The API will call this function when the video player is ready.
    function onPlayerReady(event) {
      event.target.playVideo();
    }

  </script>

  <div  class="yt-player">
    <div id="player"></div>
    <button type="button" class="yt-close-button" onclick="closeVideo()">
      <span class="icon-close"></span>
    </button>
  </div>

  @eventosHoje(eventosAgora, demaisEventosHoje, tags)

  <div class="tags">
    <button type="button" data-jplist-control="buttons-text-filter" data-path=".badge" data-group="search-group"
            data-mode="radio" data-selected="true" data-text="" class="badge badge-live" data-name="buttons-text-filter">
      Todos
    </button>
    @for(tag <- tags) {
      <button type="button"
              data-jplist-control="buttons-text-filter" data-path=".badge" data-group="search-group"
              data-mode="radio" data-text="@tag._1" class="badge badge-live" data-name="buttons-text-filter"
              data-selected='@tagSelected(tag._1)'
              style='background-color: @tag._2'
              >
        @tag._1
      </button>
    }
  </div>

  <section class="overlay bg-fixed" style='background-image: url(@routes.Assets.versioned("img/bg.jpg"));'>
    <div class="container">
      <div class="section-content" data-aos="fade-up">
        <div class="row">
          <div class="col-md-12">
            <div class="title-wrap">
              <h2>Programação</h2>
            </div>
          </div>
          <!-- Client Holder -->
          <div class="col-md-12 client-holder search-not-found-container">
            @buscaNaoEncontrada()
            <div class="client-slider">
              @for(item <- eventosDia){
              <div class="shadow dia-box">
                <div class="heading-section text-center">
                  <p>
                    @item.diaProgramacaoFmt
                  </p>
                  <h2 class="mb-4">
                    @item.diaFmt
                  </h2>
                </div>
                <div data-jplist-group="search-group">
                  @for(evento <- item.eventos){
                    @displayEvento(evento, false, tags = tags)
                  }
                </div>
              </div>
              }
            </div>
            <!-- End of Client Holder -->
          </div>
        </div>
      </div>
    </div>
  </section>
  
  <section class="bg-white">
    <div class="container">
      <div class="section-content">
        <div class="title-wrap">
          <h2 class="section-title">
            Alguma live ainda <b>não está na nossa agenda?</b> Você pode cadastrar <a class="" href="/incluir">aqui</a>.
          </h2>
          <p class="section-sub-title">
            Valorize o artista, assista nos canais oficiais
          </p>
        </div>
      </div>
    </div>
  </section>

}(Some(jsonld), true)